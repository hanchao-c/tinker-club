(function($){$.fn.dataTable.ext.errMode="none";$.fn.extend({"buildDataTable":function(option){option=option||{};var $this=$(this);var columns=option.columns;if(columns){var titles=$.map(columns,function(column,index){return column.title||column.sTitle||""});if(titles&&titles.length>0){var thead=$this.children("thead");if(thead.length==0){var $thead=$("<thead></thead>");var $tr=$("<tr></tr>");$.each(titles,function(index,title){var $th=$("<th></th>");$th.text(title);$th.appendTo($tr)});$tr.appendTo($thead);$thead.appendTo($this)}}}option.buttons=option.buttons||[];if(option.colvis){option.buttons.push({extend:"colvis",text:'<li class="fa fa-navicon"></li>',className:"",postfixButtons:[{extend:"colvisRestore",text:"重置"}]})}var _defaultAjax={"ajax":{"beforeSend":function(){},"url":option.url,"data":function(data){data.offset=data.start;data.pageSize=data.length;data.search=data.search.value;if(data.order.length>0){var target=data.columns[data.order[0].column];data.sortColumn=target.name||target.data;data.sortSequence=data.order[0].dir;if(data.sortSequence){data.sortSequence=data.sortSequence.toUpperCase()}}data.columns=undefined;data.order=undefined;data.start=undefined;data.length=undefined;if(option.ajaxData){option.ajaxData(data)}},"dataFilter":function(data,type){if(typeof data==="string"&&"json"===type.toLowerCase()){if(data.length===0){return null}if(data.indexOf("DOCTYPE html")>0){window.location.href="..";return null}}return data},"dataSrc":function(json){if(!json.data){json.data=json.content}return json.data}}};option.ajax=_defaultAjax.ajax;var _defaultSettings={"responsive":false,"autoWidth":true,"lengthChange":true,"ordering":true,"serverSide":true,"destroy":true,"displayStart":0,"scrollCollapse":true,"dom":'<"col-md-offset-6 colvis-float-right"Bf>'+"rt"+'<"col-md-4 uni-el"l><"col-md-4 uni-el"i><"col-md-4 uni-el"p>',"paging":true,"processing":true,"searching":false,"destroy":true,"displayStart":0,"lengthMenu":[10,20,50,100],"pageLength":10,"pagingType":"full_numbers","order":[],"language":{"url":"../assets/plugins/DataTables/json/dataTables.json?v2","sSearchPlaceholder":option.placeholder?option.placeholder:"search here!"},"scrollX":true,"scrollCollapse":true,};return this.DataTable($.extend({},_defaultSettings,option)).on("processing.dt",function(e,settings,processing){if(processing){$(this).prepend('<div class="panel-loader"><span class="spinner-small"></span></div>')}else{$(this).find(".panel-loader").remove()}}).on("xhr.dt",function(e,settings,json,XMLHttpRequest){if(XMLHttpRequest.status!=200){var errorResponse;try{errorResponse=JSON.parse(XMLHttpRequest.responseText)}catch(e){console.log(e)}if(errorResponse){Notification.danger(errorResponse.message,3000)}}})}})})(jQuery);