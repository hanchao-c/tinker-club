(function($){$.fn.extend({"buildSelect2":function(option){var $this=$(this);var data={};var multiple=$this.attr("multiple");option=option||{};if(option.placeholder&&!option.usePlaceholderBy){option.usePlaceholderBy=option.placeholder}if(option.search==false){data.minimumResultsForSearch=Infinity}if(option.usePlaceholderBy){data.allowClear=true;data.placeholder=option.usePlaceholderBy;if(!multiple){$this.prepend("<option></option>").val("")}}if(multiple){data.allowClear=false;if(option.maxLength&&option.maxLength>0){data.maximumSelectionLength=option.maxLength}}if(!option.type||option.type=="default"){}else{if(option.type=="data"){if(!option.data){console.log("如果类型type为data,则设置初始化数据JSONArray获取json文件路径");return}if(option.data.constructor==Array){data.data=option.data}else{if(option.data.constructor==String){data.filePath=option.data}else{console.log("data 类型错误");return}}}else{if(option.type=="remote"){if(!option.url){console.log("url不能为空");return}if(!option.usePlaceholderBy){data.placeholder="请选择...";data.allowClear=true}data.url=option.url;data.minimumInputLength=0;data.ajax={url:data.url,dataType:"json",type:"GET",delay:250,data:function(params){return $.extend({searchStr:params.term,pageNumber:params.page||1},option.params)},processResults:function(data,params){params.page=params.page||1;return{results:data.items,pagination:{more:data.hasMore}}},cache:true};data.escapeMarkup=function(markup){return markup}}else{console.log("控件type错误");return}}}data.open=option.open;data.close=option.close;data.select=option.select;data.unselect=option.unselect;if(data.filePath){$.getJSON(data.filePath,null,function(array){if(array.constructor!=Array){console.log("it is not a jsonarray file");return}data.data=array;return initSelect($this,data)})}else{return initSelect($this,data)}},"selectValues":function(){var $this=$(this);if(arguments.length>0){var source=arguments[0];if(source.constructor==String){if($this.attr("multiple")){$this.val(source.split(",")).trigger("change")}else{$this.val(source).trigger("change")}}else{if(source.constructor==Array){$this.val(source).trigger("change")}}}else{return $this.val()}},"clearSelect":function(){$(this).val(null).trigger("change")}})})(jQuery);function initSelect(selectElement,option){return selectElement.select2(option).on("select2:open",function(e){if(option.open){option.open(e)}}).on("select2:close",function(e){if(option.close){option.close(e)}}).on("select2:select",function(e){if(option.select){option.select(e)}}).on("select2:unselect",function(e){if(option.unselect){setTimeout(option.unselect,100)}})};